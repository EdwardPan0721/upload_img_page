<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>圖片上傳</title>
</head>
<body style="font-family: sans-serif; text-align: center;">
  <h2>上傳圖片</h2>
  <input type="file" id="fileInput" accept="image/*" multiple>
  <button onclick="uploadFiles()">上傳</button>
  <p id="status"></p>

  <script>
    async function uploadFile() {
      const fileInput = document.getElementById('fileInput');
      if (!fileInput.files.length) return alert('請選擇檔案');

      const file = fileInput.files[0];
      const reader = new FileReader();

      reader.onload = async function(e) {
        const base64Data = e.target.result.split(',')[1]; // 取 base64
        const formData = new FormData();
        formData.append('fileBlob', base64Data);
        formData.append('fileName', file.name);
        formData.append('mimeType', file.type);

        try {
          const response = await fetch('https://script.google.com/macros/s/AKfycbzsT_S30OruxwlGEtirjbvsiZHYnQlxLJfgDwIQHPPwP29SyjxgXyWiy7QUFpYRZAbcRw/exec', {
            method: 'POST',
            body: formData
          });
          const text = await response.text();
          document.getElementById('status').innerText = text;
        } catch(err) {
          document.getElementById('status').innerText = '上傳失敗: ' + err;
        }
      };

      reader.readAsDataURL(file);
    }
  </script>
</body>
</html>



